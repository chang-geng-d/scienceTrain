from BFV import bfv
from SM9.gmssl import sm9
import numpy as np

# # 生成公私钥对
# pk, sk = BFV.generate_keypair(128)
# print("public_key.n:", pk.n)
# print("public_key.g:", pk.g)
# print("secret_key.lam:", sk.lam)

N = 63386020445953136227006172616445766736681637258716383341795442236087382046463
G = 1294202942500246833019557380131415509820243140320038197667255004785757671901932195117513633180226471777338593861171135471808406320087569203710114396934074
LAM = 10564336740992189371167695436074294456029683891359864171427540093499102325448

# sm9
# master_public, master_secret = sm9.setup('sign')
# print(f"master_public:{master_public}")
# print(f"{master_public[0]}")
# print(f"{master_public[1]}")
# print(f"{master_public[2]}")
# print(f"{master_public[3]}")
# print(f"master_secret:{master_secret}")


P_a = (([10857046999023057135944570762232829481370756359578518086990519993285655852781,
         11559732032986387107991004021392285783925812861821192530917403151452391805634],
        [8495653923123431417604973247489272438418190587263600148770280649306958101930,
         4082367875863433681332203403145435568316851327593401208105741076214120093531], [1, 0]), (1, 2, 1), (
       10983897384846418193339927828167352897701313471551864549655503504393250521071,
       6127133906650716154829443185151619075244473018807663043181913598645801082714,
       2544694856541395873527834705305985286689930470258868316937043659856626349495),
       [14756812417781486546120471245386979191370031382224421437957406341675368933803,
        12645111657869824451595877665131425616769252602679792734157451508498288221466,
        16219429583514228568732000130078771546533475170395109877006227187408100020096,
        19327401572403689858493579732796246940293004752797994480678226967000446284370,
        13354336200169713207231621695999599430142711376870417442737603651140021831821,
        14689814796637824456809700997949404005135241560562155017630665337307074416874,
        11522165297197810405354482816965422837712095537562243950995907288281477298218,
        4052722303620656240639013150842180313027670991916374963157737603707651438632,
        20347936153899317212141371180011297223079593337745714396335866688800639149957,
        15599653636237698762474630485605990414777357751300087888410658744689527619477,
        5203418914962501213871104769396755954716647629054927111831260602273423049492,
        15843041975715887597602933791078242441388867423704047938504915704737180934134])
P_A = tuple(P_a)
S_A = 13138862018810399578557077590676975453072309600520932234053661864328966441142

P_b = (([10857046999023057135944570762232829481370756359578518086990519993285655852781,
         11559732032986387107991004021392285783925812861821192530917403151452391805634],
        [8495653923123431417604973247489272438418190587263600148770280649306958101930,
         4082367875863433681332203403145435568316851327593401208105741076214120093531], [1, 0]), (1, 2, 1), (
       8741276431086831978290149326448750954851291152902034522433467387080954844842,
       547823845530858643946578546210509112185872976324053456579297702720436112829,
       11194223607872268281636881285856540327459862565205763856108014899096832319854),
       [20653752269878573519376978618457912661606303456866746260535747227021758610579,
        13274346279045770959938120117406254045262411843369467260136616729997958834328,
        4541400001530678637551947652006810460363133238698141747918525465143644558848,
        14444090706581052275232743591818101623379992841595917797215245628840874521694,
        11386095979607537996969817957347011598984920065162894567143160876666031302820,
        7056115283551402794193586335634262514074693885104001786849567384743458684660,
        20844768206494781448178620718119870696310141591240636646228372072925471995961,
        3524354170454913725919415264955207432138135442995915363803509577133215668833,
        17321607478040315786699794094103633254663705255758378983731140604392897158028,
        17544749519598596640737407269205256234080304933571448059217618465684238919336,
        1953939771491719326376112877066305314753957436055787526772435127446501476205,
        1257335025142313313862027441699815616585315157453637055134782735049637132144])
P_B = tuple(P_b)
S_B = 8314335948445775159102164520342221763923052116847858315214783763229350314943
